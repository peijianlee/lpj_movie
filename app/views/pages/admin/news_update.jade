extends ../../layout

block content
	.container
		.row
			form.form-horizontal(method="post", action="/admin/news", enctype="multipart/form-data")
				input(type="hidden", name="news[_id]", value=news._id)
				.form-group
					label.col-sm-1.control-label 文章标题
					.col-sm-10
						input.newsTitle.form-control(type="text", name="news[title]", value=news.title)
						input.newsContent.form-control(type="text", name="news[content]",style="display:none;",value=news.content)
				.form-group
					label.col-sm-1.control-label 文章内容
					.col-sm-10
						script(type="text/javascript",src="/libs/ueditor/ueditor.config.js")
						script(type="text/javascript",src="/libs/ueditor/ueditor.all.min.js")
						script(type="text/javascript",src="/libs/ueditor/lang/zh-cn/zh-cn.js")
						script#editor(type="text/plain",style="width:100%;height:500px;")

				.form-group
					.col-sm-offset-1.col-sm-1
						button.btn.btn-mg.btn-danger.btn_save(type="sumbit")
							b.glyphicon.glyphicon-refresh
							&nbsp;&nbsp;更 新
				script.
					//实例化编辑器
					//建议使用工厂方法getEditor创建和引用编辑器实例，如果在某个闭包下引用该编辑器，直接调用UE.getEditor('editor')就能拿到相关的实例
					var ue = UE.getEditor('editor'),
						newsContent;

					function getContent() {
						var arr = [];
						//- arr.push("使用editor.getContent()方法可以获得编辑器的内容");
						//- arr.push("内容为：");
						arr.push(UE.getEditor('editor').getContent());
						newsContent = arr.join("\n");
					}

					//- 录入按键
					$('.btn_save').click(function(){
						var newsTitle = $('.newsTitle').val();
						if(newsTitle.replace(/\s/g, "")===''){
							alert('标题不能为空，或空格符')
							return false;
						}
						getContent();
						$('.newsContent').val(newsContent);
					});

					
					$(function(){
						var content = $('.newsContent').val();
						//判断ueditor 编辑器是否创建成功
						ue.addListener("ready", function () {
							// editor准备好之后才可以使用
							ue.setContent(content);
						
						});
					});
